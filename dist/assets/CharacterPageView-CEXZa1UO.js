import{P as C,y as L,e as T,l as H,m as g,k as S,C as w,c as t,s as M,Q as B,h as c,a as v,F as h,i as y,b as I,S as V,n as N,u as _,B as m,D as b,t as P,o as s,_ as D}from"./index-Cl06N649.js";async function O(n){const{data:a,error:r}=await L.from("skills").select("*").eq("character_id",n).order("type").order("order_index");if(r){console.log(r);return}return a.map(C)||[]}function i(n,a){return n.filter(e=>e.type===a).sort((e,p)=>(e.order_index??0)-(p.order_index??0))}function Z(n,a,r){return C({name:"",description:"",image_path:"",type:a,order_index:r,character_id:n})}function ee(n){return n.map(a=>{const r=n.indexOf(a)+1;return console.log("index",r),{...a,order_index:r}})}const q={key:0,class:"body"},z={key:0,class:"info-block"},j={class:"block-text"},F=["innerHTML"],$=["innerHTML"],E=["src"],Q={key:0,class:"info-block"},U={class:"block-title"},A=["src"],G={class:"block-text"},J=["innerHTML"],K=["innerHTML"],R={key:1},W=T({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(n){const a=n,r=H(),k=g(()=>a.previewCharacter?a.previewCharacter:(r.changeCurrentCharacterId(Number(a.id)),r.currentCharacter)),e=S(a.previewSkills??[]),p=S(!1);w(k,async()=>{if(!a.previewSkills&&k.value){const d=await O(k.value.id);e.value=d??[],console.log(d)}},{immediate:!0});const x=g(()=>[{key:"attack",title:"Базовая атака",skills:i(e.value,"attack")},{key:"technique",title:"Техника",skills:i(e.value,"technique")},{key:"ultimate",title:"Ульта",skills:i(e.value,"ultimate")},{key:"counter",title:"Контратака",skills:i(e.value,"counter")},{key:"dodge",title:"Уворот",skills:i(e.value,"dodge")},{key:"passive",title:"Пассивки",skills:i(e.value,"passive")},{key:"constellation",title:"Консты",skills:i(e.value,"constellation")},{key:"weapon",title:"Оружие",skills:i(e.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:i(e.value,"coreStamp")}]),f=g(()=>i(e.value,"description"));return w(e,d=>{if(!d.length)return;const u=i(d,"description");!u.length||!u[0]?.image_path?p.value=!0:p.value=!1},{immediate:!0}),(d,u)=>(s(),t("div",{class:N([{"view-container":!a.previewSkills},"character-page"])},[k.value&&e.value.length>0?M((s(),t("div",q,[f.value?(s(),t("div",z,[u[1]||(u[1]=v("p",{class:"block-title"},"Общее:",-1)),(s(!0),t(h,null,y(f.value,l=>(s(),t("div",{class:"block-skill description",key:l.id},[v("div",j,[l.name?(s(),t("p",{key:0,class:"skill-title",innerHTML:_(m)(l.name)},null,8,F)):c("",!0),l.description?(s(),t("p",{key:1,class:"skill-desc",innerHTML:_(m)(l.description)},null,8,$)):c("",!0)]),l.image_path?(s(),t("img",{key:0,src:l.preview_url??_(b)(l.image_path)??"",class:"block-skill-image",onLoad:u[0]||(u[0]=o=>p.value=!0)},null,40,E)):c("",!0)]))),128))])):c("",!0),(s(!0),t(h,null,y(x.value,l=>(s(),t(h,{key:l.key},[l.skills.length>0?(s(),t("div",Q,[v("p",U,P(l.title)+":",1),(s(!0),t(h,null,y(l.skills,o=>(s(),t("div",{class:"block-skill",key:o.id},[o.image_path?(s(),t("img",{key:0,src:o.preview_url??_(b)(o.image_path)??"",class:"block-skill-image"},null,8,A)):c("",!0),v("div",G,[o.name?(s(),t("p",{key:0,class:"skill-title",innerHTML:_(m)(o.name)},null,8,J)):c("",!0),o.description?(s(),t("p",{key:1,class:"skill-desc",innerHTML:_(m)(o.description)},null,8,K)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512)),[[B,p.value]]):(s(),t("div",R,[I(V)]))],2))}}),X=D(W,[["__scopeId","data-v-76f9eb08"]]),te=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as C,i as a,te as b,Z as c,O as g,ee as s};
