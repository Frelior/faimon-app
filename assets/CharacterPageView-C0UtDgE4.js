import{Q as C,A as L,e as T,m as H,n as m,l as S,p as w,c as t,x as M,S as I,h as c,a as g,F as v,i as y,b as V,T as B,q as N,u as _,D as h,E as b,t as q,o as s,_ as D}from"./index-CGFOQwiy.js";async function O(n){const{data:a,error:i}=await L.from("skills").select("*").eq("character_id",n).order("type").order("order_index");if(i){console.log(i);return}return a.map(C)||[]}function r(n,a){return n.filter(e=>e.type===a).sort((e,p)=>(e.order_index??0)-(p.order_index??0))}function Z(n,a,i){return C({name:"",description:"",image_path:"",type:a,order_index:i,character_id:n})}function ee(n){return n.map(a=>{const i=n.indexOf(a)+1;return console.log("index",i),{...a,order_index:i}})}const P={key:0,class:"body"},z={key:0,class:"info-block"},j={key:0,class:"block-text"},E=["innerHTML"],F=["innerHTML"],$=["src"],A={key:0,class:"info-block"},Q={class:"block-title"},U=["src"],G={class:"block-text"},J=["innerHTML"],K=["innerHTML"],R={key:1},W=T({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(n){const a=n,i=H(),k=m(()=>a.previewCharacter?a.previewCharacter:(i.changeCurrentCharacterId(Number(a.id)),i.currentCharacter)),e=S(a.previewSkills??[]),p=S(!1);w(k,async()=>{if(!a.previewSkills&&k.value){const u=await O(k.value.id);e.value=u??[],console.log(u)}},{immediate:!0});const x=m(()=>[{key:"attack",title:"Базовая атака",skills:r(e.value,"attack")},{key:"technique",title:"Техника",skills:r(e.value,"technique")},{key:"ultimate",title:"Ульта",skills:r(e.value,"ultimate")},{key:"tactic",title:"Тактик умение",skills:r(e.value,"tactic")},{key:"counter",title:"Контратака",skills:r(e.value,"counter")},{key:"dodge",title:"Уворот",skills:r(e.value,"dodge")},{key:"passive",title:"Пассивки",skills:r(e.value,"passive")},{key:"constellation",title:"Консты",skills:r(e.value,"constellation")},{key:"weapon",title:"Оружие",skills:r(e.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:r(e.value,"coreStamp")}]),f=m(()=>r(e.value,"description"));return w(e,u=>{if(!u.length)return;const d=r(u,"description");!d.length||!d[0]?.image_path?p.value=!0:p.value=!1},{immediate:!0}),(u,d)=>(s(),t("div",{class:N([{"view-container":!a.previewSkills},"character-page"])},[k.value&&e.value.length>0?M((s(),t("div",P,[f.value.length?(s(),t("div",z,[d[1]||(d[1]=g("p",{class:"block-title"},"Общее:",-1)),(s(!0),t(v,null,y(f.value,l=>(s(),t("div",{class:"block-skill description",key:l.id},[l.description?(s(),t("div",j,[l.name?(s(),t("p",{key:0,class:"skill-title",innerHTML:_(h)(l.name)},null,8,E)):c("",!0),l.description?(s(),t("p",{key:1,class:"skill-desc",innerHTML:_(h)(l.description)},null,8,F)):c("",!0)])):c("",!0),l.image_path?(s(),t("img",{key:1,src:l.preview_url??_(b)(l.image_path)??"",class:"block-skill-image",onLoad:d[0]||(d[0]=o=>p.value=!0)},null,40,$)):c("",!0)]))),128))])):c("",!0),(s(!0),t(v,null,y(x.value,l=>(s(),t(v,{key:l.key},[l.skills.length>0?(s(),t("div",A,[g("p",Q,q(l.title)+":",1),(s(!0),t(v,null,y(l.skills,o=>(s(),t("div",{class:"block-skill",key:o.id},[o.image_path?(s(),t("img",{key:0,src:o.preview_url??_(b)(o.image_path)??"",class:"block-skill-image"},null,8,U)):c("",!0),g("div",G,[o.name?(s(),t("p",{key:0,class:"skill-title",innerHTML:_(h)(o.name)},null,8,J)):c("",!0),o.description?(s(),t("p",{key:1,class:"skill-desc",innerHTML:_(h)(o.description)},null,8,K)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512)),[[I,p.value]]):(s(),t("div",R,[V(B)]))],2))}}),X=D(W,[["__scopeId","data-v-1502daa2"]]),te=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as C,r as a,te as b,Z as c,O as g,ee as s};
