import{Q as T,A as $,e as I,l as S,c as a,S as b,s as B,h as c,a as h,T as N,o as t,_ as H,m as O,n as g,p as C,x as q,U as D,F as _,i as y,b as f,V as P,q as z,u as v,D as m,w as x,E as L,t as j}from"./index-CmOZF2OY.js";async function E(n){const{data:s,error:l}=await $.from("skills").select("*").eq("character_id",n).order("type").order("order_index");if(l){console.log(l);return}return s.map(T)||[]}function i(n,s){return n.filter(e=>e.type===s).sort((e,p)=>(e.order_index??0)-(p.order_index??0))}function re(n,s,l){return T({name:"",description:"",image_path:"",type:s,order_index:l,character_id:n})}function ie(n){return n.map(s=>{const l=n.indexOf(s)+1;return console.log("index",l),{...s,order_index:l}})}const F=I({__name:"ImageModal",setup(n){const s=S(!1);return(l,o)=>(t(),a("div",{class:"image-component",onClick:o[1]||(o[1]=e=>s.value=!0)},[b(l.$slots,"default",{},void 0,!0),s.value?(t(),B(N,{key:0,to:"body"},[h("div",{onClick:o[0]||(o[0]=e=>s.value=!1),class:"modal"},[b(l.$slots,"default",{},void 0,!0)])])):c("",!0)]))}}),M=H(F,[["__scopeId","data-v-c4ae4a2b"]]),U={key:0,class:"body"},A={key:0,class:"info-block"},Q={key:0,class:"block-text"},G=["innerHTML"],J=["innerHTML"],K=["src"],R={key:0,class:"info-block"},W={class:"block-title"},X=["src"],Y={class:"block-text"},Z=["innerHTML"],ee=["innerHTML"],te={key:1},se=I({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(n){const s=n,l=O(),o=g(()=>s.previewCharacter?s.previewCharacter:(l.changeCurrentCharacterId(Number(s.id)),l.currentCharacter)),e=S(s.previewSkills??[]),p=S(!1);C(o,async()=>{if(!s.previewSkills&&o.value){const d=await E(o.value.id);e.value=d??[],console.log(d)}},{immediate:!0});const V=g(()=>[{key:"attack",title:"Базовая атака",skills:i(e.value,"attack")},{key:"special",title:"Специальная атака",skills:i(e.value,"special")},{key:"technique",title:"Техника",skills:i(e.value,"technique")},{key:"ultimate",title:"Ульта",skills:i(e.value,"ultimate")},{key:"tactic",title:"Тактик умение",skills:i(e.value,"tactic")},{key:"counter",title:"Контратака",skills:i(e.value,"counter")},{key:"dodge",title:"Уклонение",skills:i(e.value,"dodge")},{key:"passive",title:"Пассивки",skills:i(e.value,"passive")},{key:"constellation",title:"Консты",skills:i(e.value,"constellation")},{key:"weapon",title:"Оружие",skills:i(e.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:i(e.value,"coreStamp")}]),w=g(()=>i(e.value,"description"));return C(e,d=>{if(!d.length)return;const k=i(d,"description");!k.length||!k[0]?.image_path?p.value=!0:p.value=!1},{immediate:!0}),(d,k)=>(t(),a("div",{class:z([{"view-container":!s.previewSkills},"character-page"])},[o.value&&e.value.length>0?q((t(),a("div",U,[w.value.length?(t(),a("div",A,[k[1]||(k[1]=h("p",{class:"block-title"},"Общее:",-1)),(t(!0),a(_,null,y(w.value,r=>(t(),a("div",{class:"block-skill description",key:r.id},[r.description?(t(),a("div",Q,[r.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:v(m)(r.name)},null,8,G)):c("",!0),r.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:v(m)(r.description)},null,8,J)):c("",!0)])):c("",!0),f(M,null,{default:x(()=>[r.image_path?(t(),a("img",{key:0,src:r.preview_url??v(L)(r.image_path)??"",class:"block-skill-image",onLoad:k[0]||(k[0]=u=>p.value=!0)},null,40,K)):c("",!0)]),_:2},1024)]))),128))])):c("",!0),(t(!0),a(_,null,y(V.value,r=>(t(),a(_,{key:r.key},[r.skills.length>0?(t(),a("div",R,[h("p",W,j(r.title)+":",1),(t(!0),a(_,null,y(r.skills,u=>(t(),a("div",{class:"block-skill",key:u.id},[f(M,null,{default:x(()=>[u.image_path?(t(),a("img",{key:0,src:u.preview_url??v(L)(u.image_path)??"",class:"block-skill-image"},null,8,X)):c("",!0)]),_:2},1024),h("div",Y,[u.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:v(m)(u.name)},null,8,Z)):c("",!0),u.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:v(m)(u.description)},null,8,ee)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512)),[[D,p.value]]):(t(),a("div",te,[f(P)]))],2))}}),ae=H(se,[["__scopeId","data-v-3b25dcee"]]),ne=Object.freeze(Object.defineProperty({__proto__:null,default:ae},Symbol.toStringTag,{value:"Module"}));export{ae as C,M as I,i as a,ne as b,re as c,E as g,ie as s};
