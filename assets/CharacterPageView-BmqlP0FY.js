import{X as B,I as O,e as N,k as w,c as a,Y as C,q as P,h as c,Z as z,a as m,o as t,_ as V,l as D,m as f,y as x,b as _,w as y,u as v,v as M,F as h,A as L,$ as j,a0 as T,i as S,s as I,M as g,N as H,t as F}from"./index-DRxykItq.js";import{P as A}from"./overlayscrollbars-vue-CPz-uHAE.js";async function E(o){const{data:s,error:r}=await O.from("skills").select("*").eq("character_id",o).order("type").order("order_index");if(r){console.log(r);return}return s.map(B)||[]}function i(o,s){return o.filter(e=>e.type===s).sort((e,d)=>(e.order_index??0)-(d.order_index??0))}function ce(o,s,r){return B({name:"",description:"",image_path:"",type:s,order_index:r,character_id:o})}function ue(o){return o.map(s=>{const r=o.indexOf(s)+1;return console.log("index",r),{...s,order_index:r}})}const U=N({__name:"ImageModal",setup(o){const s=w(!1);return(r,n)=>(t(),a("div",{class:"image-component",onClick:n[1]||(n[1]=e=>s.value=!0)},[C(r.$slots,"default",{},void 0,!0),s.value?(t(),P(z,{key:0,to:"body"},[m("div",{onClick:n[0]||(n[0]=e=>s.value=!1),class:"modal"},[C(r.$slots,"default",{},void 0,!0)])])):c("",!0)]))}}),$=V(U,[["__scopeId","data-v-c4ae4a2b"]]),X={class:"wrapper"},Y={class:"body"},Z={key:0,class:"info-block"},G={key:0,class:"block-text"},J=["innerHTML"],K=["innerHTML"],Q=["src"],R={key:0,class:"info-block"},W={class:"block-title"},ee=["src"],te={class:"block-text"},se=["innerHTML"],ae=["innerHTML"],le={key:1},re=N({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(o){const s=o,r=D(),n=f(()=>s.previewCharacter?s.previewCharacter:(r.changeCurrentCharacterId(Number(s.id)),r.currentCharacter)),e=w(s.previewSkills??[]),d=w(!1);x(n,async()=>{if(!s.previewSkills&&n.value){const k=await E(n.value.id);e.value=k??[],console.log(k)}},{immediate:!0});const q=f(()=>[{key:"attack",title:"Базовая атака",skills:i(e.value,"attack")},{key:"special",title:"Специальная Атака",skills:i(e.value,"special")},{key:"technique",title:"Техника",skills:i(e.value,"technique")},{key:"ultimate",title:"Ульта",skills:i(e.value,"ultimate")},{key:"tactic",title:"Тактик умение",skills:i(e.value,"tactic")},{key:"counter",title:"Контратака",skills:i(e.value,"counter")},{key:"dodge",title:"Уклонение",skills:i(e.value,"dodge")},{key:"passive",title:"Пассивки",skills:i(e.value,"passive")},{key:"constellation",title:"Консты",skills:i(e.value,"constellation")},{key:"weapon",title:"Оружие",skills:i(e.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:i(e.value,"coreStamp")}]),b=f(()=>i(e.value,"description"));return x(e,k=>{if(!k.length)return;const p=i(k,"description");!p.length||!p[0]?.image_path?d.value=!0:d.value=!1},{immediate:!0}),(k,p)=>(t(),a("div",{class:M([{"view-container":!s.previewSkills},"character-page"])},[_(v(A),{class:"scrollbar-root",options:{scrollbars:{autoHide:"scroll"}}},{default:y(()=>[m("div",X,[n.value&&e.value.length>0?(t(),a(h,{key:0},[_(j,{name:"fade",mode:"out-in"},{default:y(()=>[L(m("div",Y,[b.value.length?(t(),a("div",Z,[p[1]||(p[1]=m("p",{class:"block-title"},"Общее:",-1)),(t(!0),a(h,null,S(b.value,l=>(t(),a("div",{class:"block-skill description",key:l.id},[l.description?(t(),a("div",G,[l.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:v(g)(l.name)},null,8,J)):c("",!0),l.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:v(g)(l.description)},null,8,K)):c("",!0)])):c("",!0),_($,null,{default:y(()=>[l.image_path?(t(),a("img",{key:0,src:l.preview_url??v(H)(l.image_path)??"",class:"block-skill-image desc",onLoad:p[0]||(p[0]=u=>d.value=!0)},null,40,Q)):c("",!0)]),_:2},1024)]))),128))])):c("",!0),(t(!0),a(h,null,S(q.value,l=>(t(),a(h,{key:l.key},[l.skills.length>0?(t(),a("div",R,[m("p",W,F(l.title)+":",1),(t(!0),a(h,null,S(l.skills,u=>(t(),a("div",{class:"block-skill",key:u.id},[_($,null,{default:y(()=>[u.image_path?(t(),a("img",{key:0,src:u.preview_url??v(H)(u.image_path)??"",class:M(["block-skill-image",{squared:l.key==="weapon"||l.key==="coreStamp"}])},null,10,ee)):c("",!0)]),_:2},1024),m("div",te,[u.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:v(g)(u.name)},null,8,se)):c("",!0),u.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:v(g)(u.description)},null,8,ae)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512),[[T,d.value]])]),_:1}),L(_(I,null,null,512),[[T,!d.value]])],64)):(t(),a("div",le,[_(I)]))])]),_:1})],2))}}),ie=V(re,[["__scopeId","data-v-78b5d825"]]),de=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{ie as C,$ as I,i as a,de as b,ce as c,E as g,ue as s};
