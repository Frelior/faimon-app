import{Y as B,I as O,e as N,k as w,c as a,Z as C,q as P,h as c,$ as z,a as m,o as t,_ as V,l as D,m as f,x,b as v,w as y,u as _,P as j,y as M,F as h,A as L,a0 as F,a1 as T,i as S,s as I,M as g,N as H,t as A}from"./index-CkOennLO.js";async function E(n){const{data:s,error:r}=await O.from("skills").select("*").eq("character_id",n).order("type").order("order_index");if(r){console.log(r);return}return s.map(B)||[]}function i(n,s){return n.filter(e=>e.type===s).sort((e,d)=>(e.order_index??0)-(d.order_index??0))}function oe(n,s,r){return B({name:"",description:"",image_path:"",type:s,order_index:r,character_id:n})}function ce(n){return n.map(s=>{const r=n.indexOf(s)+1;return console.log("index",r),{...s,order_index:r}})}const U=N({__name:"ImageModal",setup(n){const s=w(!1);return(r,o)=>(t(),a("div",{class:"image-component",onClick:o[1]||(o[1]=e=>s.value=!0)},[C(r.$slots,"default",{},void 0,!0),s.value?(t(),P(z,{key:0,to:"body"},[m("div",{onClick:o[0]||(o[0]=e=>s.value=!1),class:"modal"},[C(r.$slots,"default",{},void 0,!0)])])):c("",!0)]))}}),$=V(U,[["__scopeId","data-v-c4ae4a2b"]]),Y={class:"wrapper"},Z={class:"body"},G={key:0,class:"info-block"},J={key:0,class:"block-text"},K=["innerHTML"],Q=["innerHTML"],R=["src"],W={key:0,class:"info-block"},X={class:"block-title"},ee=["src"],te={class:"block-text"},se=["innerHTML"],ae=["innerHTML"],le={key:1},re=N({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(n){const s=n,r=D(),o=f(()=>s.previewCharacter?s.previewCharacter:(r.changeCurrentCharacterId(Number(s.id)),r.currentCharacter)),e=w(s.previewSkills??[]),d=w(!1);x(o,async()=>{if(!s.previewSkills&&o.value){const k=await E(o.value.id);e.value=k??[],console.log(k)}},{immediate:!0});const q=f(()=>[{key:"attack",title:"Базовая атака",skills:i(e.value,"attack")},{key:"special",title:"Специальная Атака",skills:i(e.value,"special")},{key:"technique",title:"Техника",skills:i(e.value,"technique")},{key:"ultimate",title:"Ульта",skills:i(e.value,"ultimate")},{key:"tactic",title:"Тактик умение",skills:i(e.value,"tactic")},{key:"counter",title:"Контратака",skills:i(e.value,"counter")},{key:"dodge",title:"Уклонение",skills:i(e.value,"dodge")},{key:"passive",title:"Пассивки",skills:i(e.value,"passive")},{key:"constellation",title:"Консты",skills:i(e.value,"constellation")},{key:"weapon",title:"Оружие",skills:i(e.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:i(e.value,"coreStamp")}]),b=f(()=>i(e.value,"description"));return x(e,k=>{if(!k.length)return;const p=i(k,"description");!p.length||!p[0]?.image_path?d.value=!0:d.value=!1},{immediate:!0}),(k,p)=>(t(),a("div",{class:M([{"view-container":!s.previewSkills},"character-page"])},[v(_(j),{class:"scrollbar-root",options:{scrollbars:{autoHide:"scroll"}}},{default:y(()=>[m("div",Y,[o.value&&e.value.length>0?(t(),a(h,{key:0},[v(F,{name:"fade",mode:"out-in"},{default:y(()=>[L(m("div",Z,[b.value.length?(t(),a("div",G,[p[1]||(p[1]=m("p",{class:"block-title"},"Общее:",-1)),(t(!0),a(h,null,S(b.value,l=>(t(),a("div",{class:"block-skill description",key:l.id},[l.description?(t(),a("div",J,[l.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:_(g)(l.name)},null,8,K)):c("",!0),l.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:_(g)(l.description)},null,8,Q)):c("",!0)])):c("",!0),v($,null,{default:y(()=>[l.image_path?(t(),a("img",{key:0,src:l.preview_url??_(H)(l.image_path)??"",class:"block-skill-image desc",onLoad:p[0]||(p[0]=u=>d.value=!0)},null,40,R)):c("",!0)]),_:2},1024)]))),128))])):c("",!0),(t(!0),a(h,null,S(q.value,l=>(t(),a(h,{key:l.key},[l.skills.length>0?(t(),a("div",W,[m("p",X,A(l.title)+":",1),(t(!0),a(h,null,S(l.skills,u=>(t(),a("div",{class:"block-skill",key:u.id},[v($,null,{default:y(()=>[u.image_path?(t(),a("img",{key:0,src:u.preview_url??_(H)(u.image_path)??"",class:M(["block-skill-image",{squared:l.key==="weapon"||l.key==="coreStamp"}])},null,10,ee)):c("",!0)]),_:2},1024),m("div",te,[u.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:_(g)(u.name)},null,8,se)):c("",!0),u.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:_(g)(u.description)},null,8,ae)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512),[[T,d.value]])]),_:1}),L(v(I,null,null,512),[[T,!d.value]])],64)):(t(),a("div",le,[v(I)]))])]),_:1})],2))}}),ie=V(re,[["__scopeId","data-v-98170cb9"]]),ue=Object.freeze(Object.defineProperty({__proto__:null,default:ie},Symbol.toStringTag,{value:"Module"}));export{ie as C,$ as I,i as a,ue as b,oe as c,E as g,ce as s};
