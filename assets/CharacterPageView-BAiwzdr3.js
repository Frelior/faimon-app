import{Q as C,A as L,e as T,m as H,n as m,l as S,p as w,c as e,x as M,S as I,h as c,a as g,F as v,i as y,b as V,T as B,q as N,u as _,D as h,E as b,t as q,o as t,_ as D}from"./index-B8Ea0Est.js";async function O(n){const{data:a,error:r}=await L.from("skills").select("*").eq("character_id",n).order("type").order("order_index");if(r){console.log(r);return}return a.map(C)||[]}function i(n,a){return n.filter(s=>s.type===a).sort((s,p)=>(s.order_index??0)-(p.order_index??0))}function Z(n,a,r){return C({name:"",description:"",image_path:"",type:a,order_index:r,character_id:n})}function ee(n){return n.map(a=>{const r=n.indexOf(a)+1;return console.log("index",r),{...a,order_index:r}})}const P={key:0,class:"body"},z={key:0,class:"info-block"},j={key:0,class:"block-text"},E=["innerHTML"],F=["innerHTML"],$=["src"],A={key:0,class:"info-block"},Q={class:"block-title"},U=["src"],G={class:"block-text"},J=["innerHTML"],K=["innerHTML"],R={key:1},W=T({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(n){const a=n,r=H(),k=m(()=>a.previewCharacter?a.previewCharacter:(r.changeCurrentCharacterId(Number(a.id)),r.currentCharacter)),s=S(a.previewSkills??[]),p=S(!1);w(k,async()=>{if(!a.previewSkills&&k.value){const u=await O(k.value.id);s.value=u??[],console.log(u)}},{immediate:!0});const x=m(()=>[{key:"attack",title:"Базовая атака",skills:i(s.value,"attack")},{key:"technique",title:"Техника",skills:i(s.value,"technique")},{key:"ultimate",title:"Ульта",skills:i(s.value,"ultimate")},{key:"counter",title:"Контратака",skills:i(s.value,"counter")},{key:"dodge",title:"Уворот",skills:i(s.value,"dodge")},{key:"passive",title:"Пассивки",skills:i(s.value,"passive")},{key:"constellation",title:"Консты",skills:i(s.value,"constellation")},{key:"weapon",title:"Оружие",skills:i(s.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:i(s.value,"coreStamp")}]),f=m(()=>i(s.value,"description"));return w(s,u=>{if(!u.length)return;const d=i(u,"description");!d.length||!d[0]?.image_path?p.value=!0:p.value=!1},{immediate:!0}),(u,d)=>(t(),e("div",{class:N([{"view-container":!a.previewSkills},"character-page"])},[k.value&&s.value.length>0?M((t(),e("div",P,[f.value.length?(t(),e("div",z,[d[1]||(d[1]=g("p",{class:"block-title"},"Общее:",-1)),(t(!0),e(v,null,y(f.value,l=>(t(),e("div",{class:"block-skill description",key:l.id},[l.description?(t(),e("div",j,[l.name?(t(),e("p",{key:0,class:"skill-title",innerHTML:_(h)(l.name)},null,8,E)):c("",!0),l.description?(t(),e("p",{key:1,class:"skill-desc",innerHTML:_(h)(l.description)},null,8,F)):c("",!0)])):c("",!0),l.image_path?(t(),e("img",{key:1,src:l.preview_url??_(b)(l.image_path)??"",class:"block-skill-image",onLoad:d[0]||(d[0]=o=>p.value=!0)},null,40,$)):c("",!0)]))),128))])):c("",!0),(t(!0),e(v,null,y(x.value,l=>(t(),e(v,{key:l.key},[l.skills.length>0?(t(),e("div",A,[g("p",Q,q(l.title)+":",1),(t(!0),e(v,null,y(l.skills,o=>(t(),e("div",{class:"block-skill",key:o.id},[o.image_path?(t(),e("img",{key:0,src:o.preview_url??_(b)(o.image_path)??"",class:"block-skill-image"},null,8,U)):c("",!0),g("div",G,[o.name?(t(),e("p",{key:0,class:"skill-title",innerHTML:_(h)(o.name)},null,8,J)):c("",!0),o.description?(t(),e("p",{key:1,class:"skill-desc",innerHTML:_(h)(o.description)},null,8,K)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512)),[[I,p.value]]):(t(),e("div",R,[V(B)]))],2))}}),X=D(W,[["__scopeId","data-v-8362828e"]]),te=Object.freeze(Object.defineProperty({__proto__:null,default:X},Symbol.toStringTag,{value:"Module"}));export{X as C,i as a,te as b,Z as c,O as g,ee as s};
