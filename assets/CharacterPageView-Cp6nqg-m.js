import{Q as V,A as O,e as $,l as w,c as a,S as C,s as q,h as c,a as h,T as D,o as t,_ as B,m as P,n as y,p as x,F as _,b as m,x as T,w as f,U as z,V as L,W as M,q as j,i as S,u as v,D as g,E as I,t as E}from"./index-Te2IyZ7x.js";async function F(n){const{data:s,error:l}=await O.from("skills").select("*").eq("character_id",n).order("type").order("order_index");if(l){console.log(l);return}return s.map(V)||[]}function i(n,s){return n.filter(e=>e.type===s).sort((e,d)=>(e.order_index??0)-(d.order_index??0))}function ie(n,s,l){return V({name:"",description:"",image_path:"",type:s,order_index:l,character_id:n})}function ne(n){return n.map(s=>{const l=n.indexOf(s)+1;return console.log("index",l),{...s,order_index:l}})}const U=$({__name:"ImageModal",setup(n){const s=w(!1);return(l,o)=>(t(),a("div",{class:"image-component",onClick:o[1]||(o[1]=e=>s.value=!0)},[C(l.$slots,"default",{},void 0,!0),s.value?(t(),q(D,{key:0,to:"body"},[h("div",{onClick:o[0]||(o[0]=e=>s.value=!1),class:"modal"},[C(l.$slots,"default",{},void 0,!0)])])):c("",!0)]))}}),H=B(U,[["__scopeId","data-v-c4ae4a2b"]]),A={class:"body"},Q={key:0,class:"info-block"},W={key:0,class:"block-text"},G=["innerHTML"],J=["innerHTML"],K=["src"],R={key:0,class:"info-block"},X={class:"block-title"},Y=["src"],Z={class:"block-text"},ee=["innerHTML"],te=["innerHTML"],se={key:1},ae=$({__name:"CharacterPageView",props:{id:{},previewSkills:{},previewCharacter:{}},setup(n){const s=n,l=P(),o=y(()=>s.previewCharacter?s.previewCharacter:(l.changeCurrentCharacterId(Number(s.id)),l.currentCharacter)),e=w(s.previewSkills??[]),d=w(!1);x(o,async()=>{if(!s.previewSkills&&o.value){const k=await F(o.value.id);e.value=k??[],console.log(k)}},{immediate:!0});const N=y(()=>[{key:"attack",title:"Базовая атака",skills:i(e.value,"attack")},{key:"technique",title:"Техника",skills:i(e.value,"technique")},{key:"ultimate",title:"Ульта",skills:i(e.value,"ultimate")},{key:"tactic",title:"Тактик умение",skills:i(e.value,"tactic")},{key:"counter",title:"Контратака",skills:i(e.value,"counter")},{key:"dodge",title:"Уклонение",skills:i(e.value,"dodge")},{key:"passive",title:"Пассивки",skills:i(e.value,"passive")},{key:"constellation",title:"Консты",skills:i(e.value,"constellation")},{key:"weapon",title:"Оружие",skills:i(e.value,"weapon")},{key:"coreStamp",title:"Именной штамп",skills:i(e.value,"coreStamp")}]),b=y(()=>i(e.value,"description"));return x(e,k=>{if(!k.length)return;const p=i(k,"description");!p.length||!p[0]?.image_path?d.value=!0:d.value=!1},{immediate:!0}),(k,p)=>(t(),a("div",{class:j([{"view-container":!s.previewSkills},"character-page"])},[o.value&&e.value.length>0?(t(),a(_,{key:0},[m(z,{name:"fade",mode:"out-in"},{default:f(()=>[T(h("div",A,[b.value.length?(t(),a("div",Q,[p[1]||(p[1]=h("p",{class:"block-title"},"Общее:",-1)),(t(!0),a(_,null,S(b.value,r=>(t(),a("div",{class:"block-skill description",key:r.id},[r.description?(t(),a("div",W,[r.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:v(g)(r.name)},null,8,G)):c("",!0),r.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:v(g)(r.description)},null,8,J)):c("",!0)])):c("",!0),m(H,null,{default:f(()=>[r.image_path?(t(),a("img",{key:0,src:r.preview_url??v(I)(r.image_path)??"",class:"block-skill-image",onLoad:p[0]||(p[0]=u=>d.value=!0)},null,40,K)):c("",!0)]),_:2},1024)]))),128))])):c("",!0),(t(!0),a(_,null,S(N.value,r=>(t(),a(_,{key:r.key},[r.skills.length>0?(t(),a("div",R,[h("p",X,E(r.title)+":",1),(t(!0),a(_,null,S(r.skills,u=>(t(),a("div",{class:"block-skill",key:u.id},[m(H,null,{default:f(()=>[u.image_path?(t(),a("img",{key:0,src:u.preview_url??v(I)(u.image_path)??"",class:"block-skill-image"},null,8,Y)):c("",!0)]),_:2},1024),h("div",Z,[u.name?(t(),a("p",{key:0,class:"skill-title",innerHTML:v(g)(u.name)},null,8,ee)):c("",!0),u.description?(t(),a("p",{key:1,class:"skill-desc",innerHTML:v(g)(u.description)},null,8,te)):c("",!0)])]))),128))])):c("",!0)],64))),128))],512),[[L,d.value]])]),_:1}),T(m(M,null,null,512),[[L,!d.value]])],64)):(t(),a("div",se,[m(M)]))],2))}}),le=B(ae,[["__scopeId","data-v-56396981"]]),oe=Object.freeze(Object.defineProperty({__proto__:null,default:le},Symbol.toStringTag,{value:"Module"}));export{le as C,H as I,i as a,oe as b,ie as c,F as g,ne as s};
